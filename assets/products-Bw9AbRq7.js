import{p as K,au as Q,av as W,n as X,q as Y,aw as Z,ax as _,c as M,y as ee,ay as ae,az as N,d as t,z as L,u as te,a0 as le,aA as oe,h as x,r as re,o as O,b as se,w as r,a2 as ue,a6 as p,a3 as q,a4 as v,a5 as ie,aB as I,al as de,g as ne,a7 as ce,e as s,aC as pe,aD as me,aE as ve,aF as ge,aG as Ve,aH as fe,F as be,aa as ye,V as ke}from"./index-DRo01goh.js";import{c as Ce,a as T,b as Pe,d as he,u as xe,e as A}from"./index.esm-CMBA9txL.js";import{b as j}from"./route-block-B_A1xBdJ.js";import{V as Ae,a as G}from"./VRow-ePvUHA-6.js";import{V as $e}from"./VDivider-BIgOoLQZ.js";import{m as we,a as H,V as Fe,b as Se}from"./VDataTable-DkGlApyp.js";import{V as qe}from"./VToolbar-DH1U6gx-.js";import{V as De}from"./VContainer-CPBjaDTK.js";import{V as Re}from"./VForm-Jwf8f-Vu.js";import{V as Ue}from"./VTextarea-BJ88ju0K.js";import"./VPagination-Dpf1c6HA.js";import"./VList-FjdpgoF2.js";import"./ssrBoot-COfl6kOe.js";import"./VMenu-ATGhqnRb.js";const Be=K({...Q(),...W(we(),["inline"])},"VCheckbox"),Ie=X()({name:"VCheckbox",inheritAttrs:!1,props:Be(),emits:{"update:modelValue":n=>!0,"update:focused":n=>!0},setup(n,l){let{attrs:C,slots:m}=l;const c=Y(n,"modelValue"),{isFocused:P,focus:D,blur:$}=Z(n),i=_(),w=M(()=>n.id||`checkbox-${i}`);return ee(()=>{const[F,R]=ae(C),U=N.filterProps(n),S=H.filterProps(n);return t(N,L({class:["v-checkbox",n.class]},F,U,{modelValue:c.value,"onUpdate:modelValue":h=>c.value=h,id:w.value,focused:P.value,style:n.style}),{...m,default:h=>{let{id:g,messagesId:V,isDisabled:f,isReadonly:b,isValid:y}=h;return t(H,L(S,{id:g.value,"aria-describedby":V.value,disabled:f.value,readonly:b.value},R,{error:y.value===!1,modelValue:c.value,"onUpdate:modelValue":B=>c.value=B,onFocus:D,onBlur:$}),m)}})}),{}}}),Te={class:"text-center"},Me={__name:"products",setup(n){const{t:l}=te(),{apiAuth:C}=ye(),m=le(),c=oe([]),P=x(""),D=M(()=>[{title:"ID",key:"_id",sortable:!0},{title:l("product.image"),key:"image",sortable:!1},{title:l("product.name"),key:"name",sortable:!0},{title:l("product.description"),key:"description",sortable:!0},{title:l("product.price"),key:"price",sortable:!0},{title:l("product.category"),key:"category",sortable:!0},{title:l("product.sell"),key:"sell",sortable:!0},{title:l("product.createdAt"),key:"createdAt",sortable:!0},{title:l("product.updatedAt"),key:"updatedAt",sortable:!0},{title:l("adminProduct.edit"),key:"edit",sortable:!1}]),$=async()=>{var a,o;try{const{data:d}=await C.get("/product/all");c.push(...d.result)}catch(d){console.log(d),m({text:l("api."+(((o=(a=d==null?void 0:d.response)==null?void 0:a.data)==null?void 0:o.message)||"unknownError")),snackbarProps:{color:"red"}})}};$();const i=x({open:!1,id:""}),w=a=>{a&&(i.value.id=a._id,g.value.value=a.name,V.value.value=a.price,f.value.value=a.description,b.value.value=a.category,y.value.value=a.sell),i.value.open=!0},F=()=>{h(),i.value.id="",i.value.open=!1,z.value.deleteFileRecord()},R=Ce({name:T().required(l("api.productNameRequired")),price:Pe().typeError(l("api.productPriceRequired")).required(l("api.productPriceRequired")).min(0,l("api.productPriceTooSmall")),description:T().required(l("api.productDescriptionRequired")),category:T().required(l("api.productCategoryRequired")).oneOf(["food","drink","music","phone"],l("api.productCategoryInvalid")),sell:he().required(l("api.productSellRequired"))}),{handleSubmit:U,isSubmitting:S,resetForm:h}=xe({validationSchema:R,initialValues:{name:"",price:0,description:"",category:"",sell:!1}}),g=A("name"),V=A("price"),f=A("description"),b=A("category"),y=A("sell"),B=M(()=>[{text:l("productCategory.food"),value:"food"},{text:l("productCategory.drink"),value:"drink"},{text:l("productCategory.music"),value:"music"},{text:l("productCategory.phone"),value:"phone"}]),z=x(null),k=x([]),E=x([]),J=U(async a=>{var o,d,e;if(!((o=k.value[0])!=null&&o.error)){if(i.value.id.length===0&&k.value.length===0){m({text:l("api.productImageRequired"),snackbarProps:{color:"red"}});return}try{const u=new FormData;u.append("name",a.name),u.append("price",a.price),u.append("description",a.description),u.append("category",a.category),u.append("sell",a.sell),k.value.length>0&&u.append("image",k.value[0].file),i.value.id.length>0?await C.patch("/product/"+i.value.id,u):await C.post("/product",u),c.splice(0,c.length),$(),m({text:l(i.value.id.length>0?"adminProduct.editSuccess":"adminProduct.newSuccess"),snackbarProps:{color:"green"}}),F()}catch(u){console.log(u),m({text:l("api."+(((e=(d=u==null?void 0:u.response)==null?void 0:d.data)==null?void 0:e.message)||"unknownError")),snackbarProps:{color:"red"}})}}});return(a,o)=>{const d=re("VueFileAgent");return O(),se(be,null,[t(De,null,{default:r(()=>[t(Ae,null,{default:r(()=>[t(G,{cols:"12"},{default:r(()=>[ue("h1",Te,p(a.$t("nav.adminProducts")),1)]),_:1}),t($e),t(G,{cols:"12"},{default:r(()=>[t(Fe,{items:c,headers:D.value,search:P.value},{top:r(()=>[t(qe,null,{default:r(()=>[t(q,{onClick:o[0]||(o[0]=e=>w(null))},{default:r(()=>[v(p(a.$t("adminProduct.new")),1)]),_:1}),t(ie),t(I,{modelValue:P.value,"onUpdate:modelValue":o[1]||(o[1]=e=>P.value=e),"prepend-inner-icon":"mdi-magnify",variant:"underlined"},null,8,["modelValue"])]),_:1})]),"item.image":r(({value:e})=>[t(de,{src:e,height:"50"},null,8,["src"])]),"item.sell":r(({value:e})=>[e?(O(),ne(ke,{key:0,icon:"mdi-check"})):ce("",!0)]),"item.createdAt":r(({value:e})=>[v(p(new Date(e).toLocaleString()),1)]),"item.updatedAt":r(({value:e})=>[v(p(new Date(e).toLocaleString()),1)]),"item.category":r(({value:e})=>[v(p(a.$t("productCategory."+e)),1)]),"item.edit":r(({item:e})=>[t(q,{icon:"mdi-pencil",variant:"text",onClick:u=>w(e)},null,8,["onClick"])]),_:2},1032,["items","headers","search"])]),_:1})]),_:1})]),_:1}),t(fe,{modelValue:i.value.open,"onUpdate:modelValue":o[9]||(o[9]=e=>i.value.open=e),persistent:""},{default:r(()=>[t(Re,{disabled:s(S),onSubmit:pe(s(J),["prevent"])},{default:r(()=>[t(me,null,{default:r(()=>[t(ve,null,{default:r(()=>[v(p(a.$t(i.value.id?"adminProduct.edit":"adminProduct.new")),1)]),_:1}),t(ge,null,{default:r(()=>[t(I,{modelValue:s(g).value.value,"onUpdate:modelValue":o[2]||(o[2]=e=>s(g).value.value=e),label:a.$t("product.name"),"error-messages":s(g).errorMessage.value},null,8,["modelValue","label","error-messages"]),t(I,{modelValue:s(V).value.value,"onUpdate:modelValue":o[3]||(o[3]=e=>s(V).value.value=e),label:a.$t("product.price"),"error-messages":s(V).errorMessage.value,type:"number",min:"0"},null,8,["modelValue","label","error-messages"]),t(Se,{modelValue:s(b).value.value,"onUpdate:modelValue":o[4]||(o[4]=e=>s(b).value.value=e),"error-messages":s(b).errorMessage.value,items:B.value,label:a.$t("product.category"),"item-title":"text","item-value":"value"},null,8,["modelValue","error-messages","items","label"]),t(Ie,{modelValue:s(y).value.value,"onUpdate:modelValue":o[5]||(o[5]=e=>s(y).value.value=e),label:a.$t("product.onSell"),"error-messages":s(y).errorMessage.value},null,8,["modelValue","label","error-messages"]),t(Ue,{modelValue:s(f).value.value,"onUpdate:modelValue":o[6]||(o[6]=e=>s(f).value.value=e),label:a.$t("product.description"),"error-messages":s(f).errorMessage.value},null,8,["modelValue","label","error-messages"]),t(d,{ref_key:"fileAgent",ref:z,modelValue:k.value,"onUpdate:modelValue":o[7]||(o[7]=e=>k.value=e),"raw-model-value":E.value,"onUpdate:rawModelValue":o[8]||(o[8]=e=>E.value=e),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":a.$t("fileAgent.helpText"),"error-text":{type:a.$t("fileAgent.errorType"),size:a.$t("fileAgent.errorSize")}},null,8,["modelValue","raw-model-value","help-text","error-text"])]),_:1}),t(Ve,null,{default:r(()=>[t(q,{onClick:F},{default:r(()=>[v(p(a.$t("adminProduct.cancel")),1)]),_:1}),t(q,{type:"submit",loading:s(S)},{default:r(()=>[v(p(a.$t("adminProduct.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};typeof j=="function"&&j(Me);export{Me as default};
