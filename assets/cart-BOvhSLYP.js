import{a as S,a1 as z,a0 as P,u as F,h as w,c as y,o as d,b as i,d as a,w as r,a2 as _,a6 as l,F as f,f as x,a3 as h,a4 as C,aJ as O,al as R,g as T,a7 as J,aa as U}from"./index-DMTp5kGh.js";import{b as $}from"./route-block-B_A1xBdJ.js";import{V as A,a as p}from"./VRow-0Kcf20g0.js";import{V as j,a as G}from"./VList-BLIKundf.js";import{V as q}from"./VContainer-zh8Ww08_.js";import{V as B}from"./VDivider-B0TF03DH.js";import{V as H}from"./VDataTable-DGUmv_MV.js";import"./ssrBoot-DMUClems.js";import"./VPagination-CuHjZti0.js";import"./VMenu-D4c9g25D.js";const K={class:"text-center"},M={style:{margin:"20px"}},Q={class:"text-center"},W={__name:"cart",setup(X){const{apiAuth:m}=U(),g=S(),D=z(),k=P(),{t:n}=F(),u=w([]),v=async()=>{try{const{data:t}=await m.get("/user/cart");u.value=t.result}catch(t){console.log(t)}};v();const E=y(()=>u.value.reduce((t,s)=>t+s.product.price*s.quantity,0)),I=y(()=>u.value.length>0&&u.value.every(t=>t.product.sell)),V=async(t,s)=>{var e,o;try{const{data:c}=await m.patch("/user/cart",{product:t,quantity:s});g.cart=c.result,v()}catch(c){console.log(c),k({text:n("api."+(((o=(e=c==null?void 0:c.response)==null?void 0:e.data)==null?void 0:o.message)||"unknownError")),snackbarProps:{color:"red"}})}},L=async()=>{var t,s;try{await m.post("/order"),g.cart=0,D.push("/orders")}catch(e){console.log(e),k({text:n("api."+(((s=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:s.message)||"unknownError")),snackbarProps:{color:"red"}})}},b=w([]),N=y(()=>[{title:"ID",key:"_id"},{title:n("order.createdAt"),key:"createdAt",value:t=>new Date(t.createdAt).toLocaleString()},{title:n("order.cart"),key:"cart",sortable:!1},{title:n("order.price"),key:"price",value:t=>t.cart.reduce((s,e)=>s+e.product.price*e.quantity,0)}]);return(async()=>{var t,s;try{const{data:e}=await m.get("/order");b.value=e.result}catch(e){console.log(e),k({text:n("api."+(((s=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:s.message)||"unknownError")),snackbarProps:{color:"red"}})}})(),(t,s)=>(d(),i(f,null,[a(q,null,{default:r(()=>[a(A,null,{default:r(()=>[a(p,{cols:"12"},{default:r(()=>[_("h1",K,l(t.$t("nav.cart")),1)]),_:1}),a(p,{cols:"12"},{default:r(()=>[a(j,{lines:"two"},{default:r(()=>[(d(!0),i(f,null,x(u.value,(e,o)=>(d(),i(f,{key:e._id},[a(G,{title:e.product.name,subtitle:e.product.price,"active-class":"bg-red",active:!e.product.sell},{prepend:r(()=>[a(O,{rounded:"0"},{default:r(()=>[a(R,{src:e.product.image},null,8,["src"])]),_:2},1024)]),append:r(()=>[a(h,{color:"red",icon:"mdi-minus",size:"small",class:"mr-2",onClick:c=>V(e.product._id,-1)},null,8,["onClick"]),C(" "+l(e.quantity)+" ",1),a(h,{color:"green",icon:"mdi-plus",size:"small",class:"ml-2",onClick:c=>V(e.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),o<u.value.length-1?(d(),T(B,{key:0})):J("",!0)],64))),128))]),_:1})]),_:1}),a(p,{cols:"12",class:"text-center",style:{"font-size":"20px"}},{default:r(()=>[_("p",M,l(t.$t("cart.total")+"$"+E.value),1),a(h,{style:{border:"1px solid aqua","border-radius":"30px"},disabled:!I.value,onClick:L,width:"100px"},{default:r(()=>[C(l(t.$t("cart.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),a(B),a(q,null,{default:r(()=>[a(A,null,{default:r(()=>[a(p,{cols:"12"},{default:r(()=>[_("h1",Q,l(t.$t("nav.orders")),1)]),_:1}),a(p,{cols:"12"},{default:r(()=>[a(H,{items:b.value,headers:N.value},{"item.cart":r(e=>[_("ul",null,[(d(!0),i(f,null,x(e.item.cart,o=>(d(),i("li",{key:o._id},l(o.product.name)+" x "+l(o.quantity),1))),128))])]),_:2},1032,["items","headers"])]),_:1})]),_:1})]),_:1})],64))}};typeof $=="function"&&$(W);export{W as default};
